sudo: required
language: go
go:
  - "1.13"
script:
  - make
  - 'if [ "$SNYK_TOKEN" != "" ]; then npm install -g snyk; fi'
  - 'if [ "$SNYK_TOKEN" != "" ]; then make snyk; fi'
services:
  - docker
before_deploy:
  - test -n "$TRAVIS_TAG" && docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
  - pip install --user awscli==1.16.242
deploy:
  - provider: script
    skip_cleanup: true
    script: make release
    on:
      tags: true
      condition: "$TRAVIS_OS_NAME = linux"
env:
  global:
    - AWS_DEFAULT_REGION=us-east-1
    - AWS_DEFAULT_OUTPUT=json
    # Docker Username
    - secure: "hv9x2185D2by8q1uyLXv7Uiz7jiOxsXCn4WcKg/+1HfX56GzLmQfKkr4W3PWrKXfcVOsBO1vSShcEB6wvmXD1YC3mlxbWgu7oHYRbcBZiRZr/CZOx6LUjChCN1Adxz+GhTm4aqMzt9wdRQIEX/kPO/B4ZdQzici6BreXcUwpETPcW/v+jf+SM/QtSXRUqGAwK7HubtLnaPDf0yVPqGnskmY9gg7QqAdCoNGMa4Dmw4zat/U7fycAUaaadawZqAulBOh52hpJQr6g841t3F4yoE0BRcuzmdmimR23GIk0ey0Al0CecvkKbYyDJXnjXRPQy3i/EvfX7CQXLtYtGVbmzebXvIacDLrMJDf/SPamtqCvohGGurU+XwNnoSA7Lnel5mkwYzFFVc5o7SxFPCo0fA5z8bPZnnFuCmiKwr3oXmyaVl2nNY8g2W6dC3rirVjHDVK72KzLO4nXrvjrA1UjhX3aXzvykexTYVLGBdGcvyMQkQeF60unpyc0LCKxURXZ+Q1X1sIgqmXcXX5pzvPagBGWMI9KlqLezuz8HhKjM/jsZQtCKDZcpxzZ7UXmPn7qhEQkRgoZY/pp5UFnSeWMm+NjpXu5TspzQv+q74z2i3jw83QCT1VI1tr8X0jSRxVEzlDZu10LMf9spZ1baZWhZZgbw7iZkhZSElbYyn+k7DA="
    # Docker Password
    - secure: "kQiLBcnvR668lBKcuNUhDs5J2EvU/S93Dixv6aucv23OBPgy29uidmYcKITBp3Wjnh/l7DfwJ2zxeBsKw7Z28AUpHxoSdaMQBeb3789dN0Olx0MO0Ofn9AgTC4OdV1AHXFsaVxILYJnXkOn4Pwsrv3Ugs0jOgfsCtc8jnoCouacAm50SyaeX9V5uGBOmF81yN4PgE/zQ2ZAb7Z8H3KJSd3A5GMzdPShdDCyizGQw0opyKQOxf0fUU6mQFx5yGl04IhnJCOBF4wy/EUXn+YGwCoXdjIdqFH6UlG7b70qU74bT8weAF0q7PBGSjWDWMtROk5AwIDwL3IFD+ZKv99ckyKXJTlh6utSl+rlP5M1c2Q4gre1UEDdDvT20hWdmRpFdiHCPzUWDogLWwgHHkIA1WEIfvjKOipCiNMYWvyDHSTPV5b+tGWeHKSJ3WioDR8mEtfxaaptkwI0LTFtexBKRt53CO/DxmNrpOI6GbAI9yDmj11xMVezZ9OIEGAnIpss4cyW5F1mc7ZErmHF4Bfh5vv0UVD8kVmJMGpT3B3Gn5258C4ZSZJYfY9w7Xal5AFkqTuUqBWbRPE0NcRBo87KW3xmOw8yCSBnL+r2ZHFmVtB4bjVN5nQcnVsA996Tnmw46XnGD5ZcAZ743ij9MqU8v7Jg7ehwCohbJv15yF7d+L6c="
    #  AWS secret access key
    - secure: "x7yIQegHK1H2FnpbM91ymyQ4xmgFVwURp9ebXXv4S2vuK6lbwkx01v3SqUzHr4GvwGFFXKfJaLraztAs0fWUE4thlSZGDbAIcynDMM+5BtT7Sb4HvOGjCLIv26E5Gixki/HLrpo5+jn8wDO+h9WEj6JfZmFfZIki6po97lXeUXt9ZlTeDULqDW/QGg6ejTCwerZu3eoAYKxoN5PBvSg64KMNH+H45dbQkrohGt/cXSrCpdFp3fW144PayPowpCAFpT/b/X8x60tH68ojFhrULkLFYMRtGJeb3vcNJJA1Rn7nVN7239C6l9aZ7c+rKNNNfChbW0THXOkj7ra4eQo1JIatC5cUz42nnJna7//N2MbcyQ60awKsWpBU2jjE7HHHepnNDDQ9h+6JMVWR/8PVcVm9ZPZCLl4Oc6tXtvOP5qBjlVJBbd/UF6mDrBngEVhEE1zeyTmmoLLh0jI7Y0SpU+ONgyrGHksn750kgnGbWorux9hBiVlqjANMaFN97hQjfry/clWyJDzXr6AoCxMgilLRr22x0sn9MIMqWCtWtuQYvKCRpq/dYJxEvO6RtxDbBQEQvdJs5lSnPuShk3NmbwRTfK8zWbO8TVrOkcwGdHerCus+kNmU86B8rAoRKEh/dnalOL0FYYThGIBd+S0f6HGfLq1jZWr8NveFx5vy81g="
    # AWS access key id
    - secure: "fEdjABWiQ5dXzjXARzHeneZCI47SK7NQgjGNZlHl/Hkz9oKDeH28ByGZG7LWosBIZNdHsAFLEJyUaJLNNQr6IRa5uyGmoQ4ynTUXuGvLkFcJgiu8y7bstF5uGu0fJtEj8LgGOea1qVmGVUk/cSclARRIaTXPvGhcHWQDfoph7zhRfygzpU8Hys40guSx09DcABfn6SY17AUiM45mQrrW0sbAf3EzpKK4VA0TBrWqVxuzDnRBl06md+588Sa6fGokoXX9IF7/uCZNMMKOQ7BQGQB1QmogOXC6A19CmFnvJn/FOkqNQPerFa+3hXVrgFAGcDH9890A6Dnw5VXrPT1wKRpACcYja995bYOT6vS3wwBgwzN+foTYSyP3jp0q7qLbN965dsGBmDRcCqZ0g6y672SNbyEBWETJGlcJajEatzHW++nnXJC1NTRq6JwOrsj7ZGya6nuZBgox5UbnsmSmUt02GHKvkEyN1zcwLF1ar9Ql09e9DLb8iIUdn8pvc6bLPw0lDbEz19SzPqRJW5G/VwaDUYyCxse9PdVacSpajV35cHFwnOarvzXati92A1/0mVYg2GHFu8MkLw/J/xSIIk58+lQjr9gUTuYG4N3ggRxF1d0fMOXVbOqYgDUiJ2QjO6MGdWLNEkYNV0xiQK8ax18xdNWHq5n7yb/zdn7Vom4="
    #  S3 bucket
    - secure: "UQlk3sabSGg/ANjsPznOpI5Ah7nKhkNjIuCG1KQDpPvsRc5tA6YUP9fa3OdiZQfk7eX0XYfJU95Yg+rl5kf6rqvccuo6WHJfVOuRwpicb7I49/PcKTcvlfmJjvu3H8EPygTPAT3KhRVrpfhC5c6ysC6z/30ivI8K3b6IUTjVmf2ekUu7EbmW8bzKVuDObDrkQJ2PPVmK2JgVXYLr+mSSJDTiOLBv53QxJiSMEXKv0Bjq9STDsjGSr2U+tVt2kIOF4UTcqgyhcwkUDyxLo6lo5KxeA4NwL+v4NGRMyoRRgoeaLr8ja2xY0n3TWlsNojhd0ov2dM/3rgBMte3ZPd2/HDmGOx1AFvV2hGg4LF3e4eMa7iA+11iP5kPuyi7xl6A1oFclR269dHVeAyisUaUyCQHxaqqchYtLyaY+paNSHpMCnAt2KmQsjZvy6alZ2hpSmfV6fWYE9qZ60zuqU37Tzq72157QClf3goObSOg7loclSNbW4RIXoaa9idQJAyKTO6zBpQ2qHu1MbebOZrBAjDyn98tcGx8FzVWmHJJ5Z2RHF7yDF0Qh0GULuHqddB2cf8WLVY/m3ZYTnXhleQf09olUM66SwdKnGPFXD4BXf+faTo7QIvA5Mf9GW+16fG5wZ/QR95MMjjf1RblZy1i+qVuIFSgDHu1nO4k3MrRGKgY="
    # Github token
    - secure: "2JiSdBvHBVhD2VnXjmtwGb5ccZH2aptX6SqXJEN7L+//VpUzIqbs3+l4JRFLGOCJaZp9KGEn4e9XCQ4T/TkouZWgLk/o2rcTqEc8Yol8hlm/G29YNXqoZSKrdLVitZOo7WZsT5QB8QDNp9i6+INI+GUXIPHSdigi7BVbXutR99Gn+MgX6MnGkZnDnN9OlAPofctezRUAhJlht77/1/+wI54SK12sMAC86uUiqe9GpPuP1nFz8n/Kn9Gu2DLfdzf27ooT+hvAOQTDIww+0N/kIK3TusuNN21eK22ydw6qjaYZrYgTF611cja0xiKYBt+4Zy/ac8mXJrc1jdtE2eHsCE4aqcR4+yp4wpiau0PndVjnGA9glKnLgtmvo+4QOeiF8ZBl7CKSy6xN5bhdnS79uzhDZTLMIKFho8Qdt7S7ddr+iItVraWvHIaB38ipfMW8td2hWmnZxUYCucti7+c1vrmQ4N3vpMFii8RSGobNfbF4QibZiG4iEmuaNr3ma8PdbLbVFXBkzSGHewHyrp7cq+adPxZyZbdzufaOxXeuFImj6BGOXnyK9JeCSGhnEwsJKNqiqPVjm2IM9FKMv0YyxFRhQ1lDzyLe9NGfeAAA52I/0ti+BR9x2FQZCUeLHPAfUbjEjLC4ezrR+a+u0o9+ww6RvbD8eWCCN5ojXmDin0g="
    # Snyk token
    - secure: "Lzy8A3bXf9TXDp/77kyXBvrb5di4oFNXHl/rXi0oY7QZ5QOVBp1ce+XuMrvoQNe4IA2FLqfYvoa/QCrQdxlPIcDULOUt4iGDxJ5olFi7EbMaS5cCV1thxHcmVha+jZ4Rpt+TmQQuNpVJS7CJTFr4l3Qj5LhAKtlCIq8Zf7ApllaB9hFslRMIM/Pmhk3FfuVHft6ztdRUwxmjyOKVM+liUzYDdo08LeT0f8153TvzcNnbuSPcjiXolmG+Dh0NCHhTmHzppqSjoEtwfi0CbN2v9G8Bf3Xkz3uNg3ABnOM8xmeQAa6lRH/VYQqG3HJI8iuzuoJ96LTQ2x/8qFMpsN762rtXWXeTTbSkc0wnYUvqjsoKLQDW5g5a1Z803BLGrHjXoCJTO79OHpUnuQowM6aRkBi/vtr5x4/5Tr3rTZuszd57RXYDRCNzi1z4VB+8DAzQjNdxuMFHRPfgGWYW/wtyHSGE+AIse//xRBp7HZQqz53PV8Aneq0ejii7+nKSaHbNUyypI7396QfYEJUXs9Xka+NaTFuAa4rzYX45xHyt6oIj/wAKn10WUpt1h12AFVnwuyVwaVfxMP1hCXdANm8VM2KdQkjAo+qJrmqkCfGieMXcjo2vzNRU7HSvPyu/82YVzKzFkWBNYm3ho07xb96qRuiPNNblCdKD5B/MDWLEuZI="
